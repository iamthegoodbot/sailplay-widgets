var SAILPLAY=function(){function a(){alert("Please init SailPlay HUB first!")}function b(a){function b(a){return"login.success"==a.data.name?void f.send("login.do",a.data.auth_hash):"login.cancel"==a.data.name?void f.send("login.cancel"):"login.check"==a.data.name?void("None"==a.data.auth_hash?f.send("logout"):f.send("login.do",a.data.auth_hash)):void("logout.success"==a.data.name&&(h.auth_hash="",d.eraseCookie("sp_auth_hash"),f.send("logout.success")))}if("undefined"==typeof Porthole)return void alert("SailPlay: Porthole.js library need to be installed");1==a.nodeType&&"IFRAME"==a.tagName?(a.src=h.DOMAIN+"/users/auth-page/?partner_id="+h.partner.id+"&dep_id="+h.dep_id,j=new Porthole.WindowProxy("",a.name),j.addEventListener(b)):alert("SailPlay: provide <iframe> DOM element as parameter (Remote login)")}function c(a){var b={gift_public_key:a.gift_public_key,auth_hash:h.auth_hash};e.get(h.DOMAIN+h.urls.gifts.purchase.force_confirm,b,function(a){"ok"==a.status?f.send("gift.purchase.force_complete.success",a):f.send("gift.purchase.force_complete.error",a)})}Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=c<0?Math.ceil(c):Math.floor(c),c<0&&(c+=b);c<b;c++)if(c in this&&this[c]===a)return c;return-1});var d={createCookie:function(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="; expires="+d.toGMTString()}else var e="";document.cookie=a+"="+b+e+"; path=/"},readCookie:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null},eraseCookie:function(a){d.createCookie(a,"",-1)}},e={currentScript:null,get:function(a,b,c,d){var e=a+(a.indexOf("?")+1?"&":"?"),f=document.getElementsByTagName("head")[0],g=document.createElement("script"),i=[];h.auth_hash||delete b.auth_hash,window.JSONP_CALLBACK=window.JSONP_CALLBACK||{};var j="sailplay_"+(new Date).getTime()+Math.random().toString().replace(".",""),k=setTimeout(function(){try{f.removeChild(g)}catch(a){}delete window.JSONP_CALLBACK[j]},2e4);window.JSONP_CALLBACK[j]=function(a){clearTimeout(k),g&&f.removeChild(g),delete window.JSONP_CALLBACK[j],c&&c(a)},b.callback="JSONP_CALLBACK."+j;for(var l in b)i.push(l+"="+encodeURIComponent(b[l]));e+=i.join("&"),g.type="text/javascript",g.src=e,g.onerror=function(a){g&&f.removeChild(g),delete window.JSONP_CALLBACK[j],d&&d(a)},f.insertBefore(g,f.firstChild)},success:null},f={},g={};f.on=function(a,b){void 0===g[a]&&(g[a]=[]),g[a].push(b)},f.send=function(a,b){if(g[a])for(var c=0;c<g[a].length;c++)g[a][c](b)};var h={},i={},j=!1;f.on("init",function(a){if(a||alert("SailPlay: provide required parameters"),!a.partner_id)return void alert("SailPlay: provide partner_id");e.get(window.location.protocol+"//sailplay.ru/js-api/"+a.partner_id+"/config/",{lang:a.lang||"ru"},function(b){b&&"ok"==b.status?(h=b.config,h.DOMAIN=window.location.protocol+"//sailplay.ru",h.dep_id=a.dep_id||"",h.env.staticUrl=a.static_url||h.env.staticUrl,f.send("init.success",h)):(f.send("init.error",b),alert("SailPlay: app load failed!"))})}),f.on("init.remote",function(a){b(a)}),f.on("language.set",function(b){if(h=={})return void a();"string"==typeof b&&e.get(h.DOMAIN+"/js-api/"+h.partner.id+"/config/",{lang:b},function(a){a&&"ok"==a.status?(h.lang=a.config.lang,f.send("language.set.success",h.lang)):f.send("language.set.error",a)})}),f.config=function(){return h},f.on("login.do",function(a){h.auth_hash=a;var b={auth_hash:h.auth_hash};e.get(h.DOMAIN+h.urls.users.info,b,function(a){"ok"==a.status?f.send("login.success",a.user):(h.auth_hash="",f.send("login.error",a))})}),f.on("login",function(b){if(h=={})return void a();f.send("login.do",b)}),f.on("logout",function(){if(h=={})return void a();h.auth_hash&&j&&j.post({name:"logout"}),h.auth_hash="",d.eraseCookie("sp_auth_hash"),f.send("logout.success")}),f.on("load.user.info",function(){if(h=={})return void a();var b={auth_hash:h.auth_hash,user_status:1,badges:1,last_badge:1};e.get(h.DOMAIN+h.urls.users.info,b,function(a){"ok"==a.status?f.send("load.user.info.success",a):f.send("load.user.info.error",a)})}),f.on("load.user.history",function(){if(h=={})return void a();var b={auth_hash:h.auth_hash};e.get(h.DOMAIN+h.urls.users.history,b,function(a){"ok"==a.status?f.send("load.user.history.success",a.history):f.send("load.user.history.error",a)})}),f.on("gifts.get",function(b){if(h=={})return void a();var c={gift_id:b,auth_hash:h.auth_hash};e.get(h.DOMAIN+h.urls.gifts.get,c,function(a){"ok"==a.status?f.send("gifts.get.success",a.gift):f.send("gifts.get.error",a)})}),f.on("load.gifts.list",function(){if(h=={})return void a();var b={auth_hash:h.auth_hash};e.get(h.DOMAIN+h.urls.gifts.list,b,function(a){"ok"==a.status?f.send("load.gifts.list.success",a.gifts):f.send("load.gifts.list.error",a)})}),f.on("gifts.purchase",function(b){if(h=={})return void a();if(h.auth_hash){var d={gift_id:b.id,dep_id:h.dep_id||h.partner.depId||"",auth_hash:h.auth_hash};e.get(h.DOMAIN+h.urls.gifts.purchase.purchase,d,function(a){if("ok"==a.status){if(f.send("gifts.purchase.success",a),a.is_completed){var b=a;if(b.request_to_partner_url){var d={gift_public_key:b.gift_public_key,gift_sku:b.gift_sku,auth_hash:h.auth_hash};b.user_phone&&(d.user_phone=b.user_phone),b.email&&(d.email=b.email),e.get(b.request_to_partner_url,d,function(a){f.send("gifts.purchase.partner_request.success",a)},function(a){f.send("gifts.purchase.partner_request.error",a),c(b)})}else c(b)}}else f.send("gift.purchase.error",a)})}else f.send("gifts.purchase.auth.error",b)}),f.on("load.badges.list",function(){if(h=={})return void a();var b={auth_hash:h.auth_hash};e.get(h.DOMAIN+h.urls.badges.list,b,function(a){"ok"==a.status?f.send("load.badges.list.success",a):f.send("load.badges.list.error",a)})}),f.on("load.actions.list",function(){if(h=={})return void a();var b={auth_hash:h.auth_hash};e.get(h.DOMAIN+h.urls.actions.load,b,function(a){"ok"==a.status?(i=a.data,f.send("load.actions.list.success",a.data)):f.send("load.actions.list.error",a)})});var k={};return k.openSocialRegNeedPopup=function(a){var b;b="vk"==a.socialType?k.popupWindow(i.social.vk.authUrl,"social_reg",840,400):k.popupWindow(i.social[a.socialType].authUrl,"social_reg");var c=setInterval(function(){(null==b||b.closed)&&(f.send("actions.social.connect.complete"),clearInterval(c))},100)},k.popupWindow=function(a,b,c,d){var e,f,g,h;return void 0!==c&&void 0!==d?(e=c,f=d,g=screen.width/2-c/2,h=screen.height/2-d/2):(e=screen.width/2,f=screen.height/2,g=e-e/2,h=f-f/2),window.open(a,b,"toolbar=no, location=no, directories=no, status=no, menubar=no, copyhistory=no, width="+e+", height="+f+", top="+h+", left="+g)},k.share=function(a){var b=h.DOMAIN+"/js-api/"+h.partner.id+"/actions/social-widget/?auth_hash="+h.auth_hash;b+="&socialType="+a.socialType+"&action="+a.action+"&link="+a.shortLink+"&pic="+(i.partnerCustomPic?i.partnerCustomPic:h.partner.logo),b+="&msg="+i.messages[a.action],b+="&_actionId="+a._actionId,"purchase"==a.action&&(b+="&purchasePublicKey="+i.purchasePublicKey);var c=k.popupWindow(b,"social_action",200,210),d=setInterval(function(){(null==c||c.closed)&&(f.send("actions.perform.complete",a),clearInterval(d))},200)},k.perform=function(a){var b=h.DOMAIN+"/popup/"+h.partner.id+"/widgets/custom/"+a.type+"/?auth_hash="+h.auth_hash;b+="&lang="+h.lang,b+="&from_sdk=0";var c=k.popupWindow(b,"SailPlay",600,400),d=setInterval(function(){(null==c||c.closed)&&(f.send("actions.perform.complete",a),clearInterval(d))},200)},f.on("actions.perform",function(b){if(h=={})return void a();h.auth_hash?(f.send("actions.perform.start",b),b.socialType&&i.connectedAccounts?i.connectedAccounts[b.socialType]?k.share(b):k.openSocialRegNeedPopup(b):b.socialType||k.perform(b)):f.send("actions.perform.auth.error",b)}),f.on("promocodes.apply",function(b){if(h=={})return void a();b.auth_hash=h.auth_hash,h.auth_hash?e.get(h.DOMAIN+h.urls.promocodes.apply,b,function(a){"ok"==a.status?f.send("promocodes.apply.success",a):f.send("promocodes.apply.error",a)}):f.send("promocodes.apply.auth.error",action)}),f.on("tags.add",function(b){if(h=={})return void a();if(h.auth_hash){var c={tags:b.join(","),auth_hash:h.auth_hash};e.get(h.DOMAIN+h.urls.tags.add,c,function(a){"ok"==a.status?f.send("tags.add.success",a):f.send("tags.add.error",a)})}else SAILPLAY.trigger("tags.add.auth.error",b)}),f.on("leaderboard.load",function(){if(h=={})return void a();var b={auth_hash:h.auth_hash};e.get(h.DOMAIN+h.urls.leaderboard.data,b,function(a){"ok"==a.status?f.send("leaderboard.load.success",a.data):f.send("leaderboard.load.error",a)})}),f}();angular.module("pj.filters",[]).filter("short_number",function(){return function(a){function b(a,b,d,e){if(a=Number(a),!1!==(e=e||!1))return c(a,b,d,e);var f;return f=a>=1e12?"T":a>=1e9?"B":a>=1e6?"M":a>=1e3?"K":"",c(a,b,d,f)}function c(a,b,c,d){var e=0;switch(d){case"T":e=a/1e12;break;case"B":e=a/1e9;break;case"M":e=a/1e6;break;case"K":e=a/1e3;break;case"":e=a}if(!1!==b){new RegExp("\\.\\d{"+(b+1)+",}$").test(""+e)&&(e=e.toFixed(b))}!1!==c&&(e=Number(e).toFixed(c));var f=e.toString().split("."),g=f[1]?f[1][0]:"0";return f[0]+("0"!=g?"."+g:"")+d}return b(a,2,!1,!1)}}).filter("truncate",function(){return function(a,b){return!b||!a||a.length<=b?a:a.substring(0,b)+"..."}}).filter("to_html",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]).filter("static",["config",function(a){return function(b){var c=a.env.staticUrl;return c?c+b:""}}]).filter("media",["config",function(a){return function(b){var c=a.env.mediaUrl;return c?c+b:""}}]).filter("humanizeUserHistoryAction",["$rootScope",function(a){return function(b){switch(b.action){case"event":case"extra":return b.name;case"sharing":switch(b.social_action){case"like":return a.translate.history.items.enter_group+b.social_type;case"purchase":return a.translate.history.items.share_purchase+b.social_type;case"partner_page":return a.translate.history.items.social_share+b.social_type;case"badge":return a.translate.history.items.share_badge+b.social_type}}return a.translate.history.items[b.action]}}]).filter("divide",function(){return function(a,b,c){return(a||[]).slice(c,c+b)}}),angular.module("pj.services",[]).service("translate",["$rootScope",function(a){var b=this;b.lang="pl",b.setLang=function(c){b.lang=c,a.translate=b[b.lang]},b.pl={badges:{intro:"Congratulations, you received a new badge!",bonus_points:"bonus points!",this_badge:"This badge gives you",share_this_news:"Share that:",title:"List of badges",descr:"You get 15 extra points for every badge received!"},profile:{no_name:"Name is not specified",confirmed_points:"Active points",history_link:"Transactions history",unconfirmed_points:"Nieaktywne punkty.",what_is_it:"Co to jest?",what_is_unconfirmed_points:"Co to są<br> nieaktywne<br> punkty premiowe?",purchases:"Otrzymujesz punkty premiowe za zakupy oraz inne akcje.",confirm_points:"Punkty stają się aktywne po dokonaniu płatności za towje zamówienie.",points_to_gift:"Punkty premiowe mogą być zamienione na specjalne podarunki."},purchase:{bonus_for_sharing:"za każde polecenie ",purchase_points:"Punkty zdobyte",hello:"Welcome<br/>to<br/>PapaBonus",promo_text:"Zamów pizzę i zaproś znajomych, a otrzymasz punkty premii i darmową pizzę.",link_text:"Idż do Premii Papa",papa_bonus:"Papa Bonus"},history:{title:"Transactions history",no_descr:"No description",items:{purchase:"Purchase",gift_purchase:"Gift",badge:"Badge",registration:"Sign up",referral:"Invite friend",referred:"Registration from friend's invite",referred_purchase:"Friend's purchase",promocode:"Promocode activation",enter_group:"Joined our group on ",share_purchase:"Shared a purchase on ",social_share:"Shared our website on ",share_badge:"Shared a badge on "}},gifts:{title:"List of gifts",descr:"Redeem your points for gifts",auth_request:"You need to be authorized to get our gifts",login:"Sign in",need_more_1:"Aby otrzymać ten dar trzeba kolejne",need_more_2:"punktów",get_points:"Zdobądź",enough_points:"You have enough bonus points to get this gift.",to_basket:"Dodaj do zamówienia",points:"points"},actions:{title:"List of quests",descr:"Complete quests to get extra points",no_descr:"No description",earn_points:"Earn points",share:"Share",join:"Join",ac_connected:'Your account was successfully linked to your profile. Press "Share" to earn bonus points.',ac_connected_join:'Your account was successfully linked to your profile. Press "Join" to earn bonus points.',system:{emailBinding:"Enter email",fillProfile:"Fill profile",inviteFriend:"Invite friend"},social:{vk:{like:{name:"Join the group"},partner_page:{name:"Share our website on VK"},purchase:{name:"Share your purchase on VK"}},fb:{like:{name:"Like Facebook group"},partner_page:{name:"Share our website on Facebook"},purchase:{name:"Share your purchase on Facebook"}},gp:{like:{name:"Like G+ group"},partner_page:{name:"Share our website on G+"},purchase:{name:"Share your purchase on G+"}},ok:{like:{name:"Join the group"},partner_page:{name:"Share our website on Odnoklassniki"},purchase:{name:"Share you purchase on Odnoklassniki"}},tw:{partner_page:{name:"Share our website on twitter"},purchase:{name:"Share your purchase on twitter"}}}}},b.ru={badges:{intro:"Поздравляем, вы получили новый бейдж!",bonus_points:"бонусных баллов!",this_badge:"Этот бейдж дает вам дополнительно",share_this_news:"Поделитесь этой новостью:",title:"Список бейджиков",descr:"За каждый бейджик Вы получаете 15 дополнительных баллов!"},profile:{no_name:"Имя не указано",confirmed_points:"Подтвержденные баллы",history_link:"История начислений",unconfirmed_points:"Неподтвержденные баллы",what_is_it:"Что это?",what_is_unconfirmed_points:"Что такое<br> неподтвержденные<br> бонусные баллы?",purchases:"За покупки и другие действия вам начисляются бонусные баллы",confirm_points:"Баллы подтверждаются после выкупа заказа и фактической оплаты",points_to_gift:"Подтвержденные бонусные баллы можно обменять на подарки"},purchase:{bonus_for_sharing:"баллов за каждый рассказ о покупке",purchase_points:"баллов будет подтверждено",hello:"Добро<br/>пожаловать<br/>в ПапаБонус",promo_text:"Закажите пиццу и приглашайте друзей, чтобы зарабатывать бонусые баллы и получать подарки!",link_text:"Перейти в ПапаБонус",papa_bonus:"ПапаБонус"},history:{title:"История начислений",no_descr:"Нет описания",items:{purchase:"Покупка",gift_purchase:"Подарок",badge:"Бейджик",registration:"Регистрация",referral:"Регистрация друга",referred:"Регистрация по приглашению",referred_purchase:"Покупка приглашенного пользователя",promocode:"За ввод промокода",enter_group:"Вступление в группу ",share_purchase:"Рассказ о покупке в ",social_share:"Рассказ в ",share_badge:"Рассказ о бейджике в "}},gifts:{title:"Список подарков",descr:"Потратьте ваши баллы на подарки",auth_request:"Чтобы получить подарок, необходимо авторизоваться",login:"Войти",need_more_1:"Чтобы получить этот подарок, необходимо набрать еще",need_more_2:"баллов",get_points:"Заработать",enough_points:"У Вас достаточно баллов. Вы можете получить этот подарок.",to_basket:"В корзину",points:"баллов"},actions:{title:"Список заданий",descr:"Выполняйте задания и получайте за них дополнительные баллы",no_descr:"Нет описания",earn_points:"Получить баллы",share:"Поделиться",join:"Вступить",ac_connected:'Ваш аккаунт успешно привязан. Нажмите "Поделиться", чтобы получить бонусные баллы.',ac_connected_join:'Ваш аккаунт успешно привязан. Нажмите "Вступить", чтобы получить бонусные баллы.',system:{emailBinding:"Указать E-mail",fillProfile:"Заполнить профиль",inviteFriend:"Пригласить друга"},social:{vk:{like:{name:"Вступить в группу"},partner_page:{name:"Рассказать о PapaJohns в VK"},purchase:{name:"Рассказать о покупке в VK"}},fb:{like:{name:"Вступить в группу"},partner_page:{name:"Рассказать о PapaJohns в FB"},purchase:{name:"Рассказать о покупке в FB"}},gp:{like:{name:"Лайкнуть в GP"},partner_page:{name:"Рассказать о PapaJohns в GP"},purchase:{name:"Рассказать о покупке в GP"}},ok:{like:{name:"Вступить в группу"},partner_page:{name:"Рассказать о PapaJohns в OK"},purchase:{name:"Рассказать о покупке в OK"}},tw:{partner_page:{name:"Рассказать о PapaJohns в TW"},purchase:{name:"Рассказать о покупке в Tw"}}}}},b.en={badges:{intro:"Congratulations, you received a new badge!",bonus_points:"bonus points!",this_badge:"This badge gives you",share_this_news:"Share that:",title:"List of badges",descr:"You get 15 extra points for every badge received!"},profile:{no_name:"Name is not specified",confirmed_points:"Active points",history_link:"Transactions history",unconfirmed_points:"Inactive points",what_is_it:"What is this?",what_is_unconfirmed_points:"What is<br> inactive<br> bonus points?",purchases:"You earn bonus points for purchases and other actions",confirm_points:"Points are activated after you pay for your purchase",points_to_gift:"Active bonus points can be redeemed for special gifts"},purchase:{bonus_for_sharing:"for each share",purchase_points:"points earned",hello:"Welcome<br/>to<br/>PapaBonus",promo_text:"Order pizza and invite friends to earn more bonus points and get free pizza.",link_text:"Go to Papa Bonus",papa_bonus:"Papa Bonus"},history:{title:"Transactions history",no_descr:"No description",items:{purchase:"Purchase",gift_purchase:"Gift",badge:"Badge",registration:"Sign up",referral:"Invite friend",referred:"Registration from friend's invite",referred_purchase:"Friend's purchase",promocode:"Promocode activation",enter_group:"Joined our group on ",share_purchase:"Shared a purchase on ",social_share:"Shared our website on ",share_badge:"Shared a badge on "}},gifts:{title:"List of gifts",descr:"Redeem your points for gifts",auth_request:"You need to be authorized to get our gifts",login:"Sign in",need_more_1:"To get this gift you need more",need_more_2:"points",get_points:"Earn",enough_points:"You have enough bonus points to get this gift.",to_basket:"Add to order",points:"points"},actions:{title:"List of quests",descr:"Complete quests to get extra points",no_descr:"No description",earn_points:"Earn points",share:"Share",join:"Join",ac_connected:'Your account was successfully linked to your profile. Press "Share" to earn bonus points.',ac_connected_join:'Your account was successfully linked to your profile. Press "Join" to earn bonus points.',system:{emailBinding:"Enter email",fillProfile:"Fill profile",inviteFriend:"Invite friend"},social:{vk:{like:{name:"Join the group"},partner_page:{name:"Share our website on VK"},purchase:{name:"Share your purchase on VK"}},fb:{like:{name:"Like Facebook group"},partner_page:{name:"Share our website on Facebook"},purchase:{name:"Share your purchase on Facebook"}},gp:{like:{name:"Like G+ group"},partner_page:{name:"Share our website on G+"},purchase:{name:"Share your purchase on G+"}},ok:{like:{name:"Join the group"},partner_page:{name:"Share our website on Odnoklassniki"},purchase:{name:"Share you purchase on Odnoklassniki"}},tw:{partner_page:{name:"Share our website on twitter"},purchase:{name:"Share your purchase on twitter"}}}}}}]),function(a){if(void 0===a)return void alert("SailPlay HUB needed to work");var b=angular.module("sailplay.pj",["pj.filters","pj.services"]);b.service("config",function(){return a.config()||{}}),b.run(["$rootScope","translate","config",function(a,b,c){b.setLang(c.lang||b.lang||"ru"),SAILPLAY.on("language.set.success",function(c){b.setLang(c),a.$apply()}),SAILPLAY.on("login.success",function(){SAILPLAY.send("load.user.info"),SAILPLAY.send("load.user.history")})}]),b.directive("sailplayUserProfile",function(){var a="";return a+='<table class="user_info_wrapper myriad" data-ng-show="user_obj" data-ng-cloak>',a+="   <tr>",a+='      <td style="padding-left: 40px; width: 10%;"> <img data-ng-src="{{ user_obj.user.pic }}" alt="user_icon" class="oldify user_pic"/>  </td>',a+='      <td style="border-right: 1px dotted #bdbbb5; padding-right: 30px; width: 20%;">',a+='         <p class="rockwell" style="font-size: 18px;" data-ng-bind="user_obj.user.name || translate.profile.no_name"></p>',a+='         <p data-ng-show="user_obj.last_badge.name" class="myriad user_badge" data-ng-bind="user_obj.last_badge.name"></p>',a+="      </td>",a+='      <td style="padding-left: 30px; width: 10%;">',a+='         <div class="points_circle confirmed oldify">  <span class="rockwell" data-ng-bind="user_obj.user_points.confirmed | short_number"></span></div>',a+="      </td>",a+='      <td style="border-right: 1px dotted #bdbbb5; padding-right: 20px; width: 20%;">',a+='         <p style="font-size: 14px;" data-ng-bind="translate.profile.confirmed_points"></p>',a+='         <a href="#" style="font-size: 14px; text-decoration: underline;" class="green_text" data-ng-bind="translate.profile.history_link" data-ng-click=\'$event.preventDefault();change_type("history")\'></a>',a+="      </td>",a+='      <td style="padding-left: 30px; width: 10%;">',a+='         <div class="points_circle unconfirmed oldify">  <span class="rockwell" data-ng-bind="user_obj.user_points.unconfirmed | short_number"></span></div>',a+="      </td>",a+='      <td style="padding-right: 20px; width: 20%;">',a+='         <p style="font-size: 14px;" data-ng-bind="translate.profile.unconfirmed_points"></p>',a+='         <div style="position: relative;">',a+='            <a class="green_text" style="font-size: 14px; text-decoration: underline; position: relative;" data-ng-click="show_points_help = !show_points_help" data-ng-bind="translate.profile.what_is_it"></a> ',a+='            <div class="hint help_points" data-ng-show="show_points_help">',a+='               <div class="close_btn" data-ng-click="show_points_help = !show_points_help">×</div>',a+='               <div class="caption" data-ng-bind-html="translate.profile.what_is_unconfirmed_points | to_html"></div>',a+='               <div class="steps">',a+='                  <div class="step step1">',a+='                     <div class="step_pic">',a+='                        <div class="unconfirmed_points_circle diameter50">100</div>',a+="                     </div>",a+='                     <div class="text_help" data-ng-bind="translate.profile.purchases"></div>',a+='                     <div class="arrow"></div>',a+="                  </div>",a+='                  <div class="step step2">',a+='                     <div class="step_pic">',a+='                        <div class="card_pic"></div>',a+="                     </div>",a+='                     <div class="text_help" data-ng-bind="translate.profile.confirm_points"></div>',a+='                     <div class="arrow"></div>',a+="                  </div>",a+='                  <div class="step step3">',a+='                     <div class="step_pic">',a+='                        <div class="points_circle diameter50">400</div>',a+="                     </div>",a+='                     <div class="text_help" data-ng-bind="translate.profile.points_to_gift"></div>',a+="                  </div>",a+='                  <div class="clearfix"></div>',a+="               </div>",a+="            </div>",a+="         </div>",a+="      </td>",a+="   </tr>",a+="</table>",{restrict:"E",scope:!0,replace:!0,template:a,link:function(a){a.user_obj=!1,a.loaded=!0,a.change_type=function(a){$rootScope.$emit("route",a)},SAILPLAY.on("language.set.success",function(){SAILPLAY.send("load.user.info")}),SAILPLAY.on("load.user.info.success",function(b){a.$apply(function(){a.user_obj=b})}),SAILPLAY.on("logout",function(){a.$apply(function(){a.user_obj=!1})})}}}),b.directive("sailplayUserPizzaProfile",["$rootScope",function(a){var b="";return b+='<table class="user_info_wrapper myriad" data-ng-show="user_obj" data-ng-cloak>',b+="   <tr>",b+='      <td style="padding-left: 30px; padding-right: 30px; width: 2%;  border-right: 1px dotted #bdbbb5;" rowspan="2">',b+='         <sailplay-pizzameter style="width: 250px; height: 250px"></sailplay-pizzameter>',b+="      </td>",b+='      <td style="padding-right: 15px; width: 10%; vertical-align: bottom; padding-bottom: 0px;"> <img style="float: right;" data-ng-src="{{ user_obj.user.pic }}" alt="user_icon" class="oldify user_pic"/> </td>',b+=' \t\t <td style="vertical-align: bottom;  padding-bottom: 10px; padding-left: 0px;">',b+='         <p class="rockwell" style="font-size: 18px;" data-ng-bind="user_obj.user.name || translate.profile.no_name"></p>',b+='         <p data-ng-show="user_obj.last_badge.name" class="myriad user_badge" data-ng-bind="user_obj.last_badge.name"></p>',b+='         <a href="#" style="font-size: 14px; text-decoration: underline;" class="green_text" data-ng-bind="translate.profile.history_link"  data-ng-click=\'$event.preventDefault();change_type("history")\'></a>',b+=" \t\t </td>",b+=" \t</tr>",b+=" \t<tr>",b+=' \t\t<td style="padding-right: 15px; width: 25%;vertical-align: top; padding-top: 10px;text-align: right;">',b+=' \t\t\t<div class="points_circle unconfirmed oldify">  <span class="rockwell" data-ng-bind="user_obj.user_points.unconfirmed | short_number"></span></div> ',b+=" \t\t</td>",b+='      <td style="border-right: 1px dotted #bdbbb5; padding-right: 30px; width: 35%; vertical-align: top; padding-top: 25px;padding-left: 0px;">',b+='         <p style="font-size: 14px;" data-ng-bind="translate.profile.unconfirmed_points"></p>',b+='         <div style="position: relative;">',b+='            <a class="green_text" style="font-size: 14px; text-decoration: underline; position: relative;" data-ng-click="show_points_help = !show_points_help" data-ng-bind="translate.profile.what_is_it"></a> ',b+='            <div class="hint help_points" data-ng-show="show_points_help">',b+='               <div class="close_btn" data-ng-click="show_points_help = !show_points_help">×</div>',b+='               <div class="caption" data-ng-bind-html="translate.profile.what_is_unconfirmed_points | to_html"></div>',b+='               <div class="steps">',b+='                  <div class="step step1">',b+='                     <div class="step_pic">',b+='                        <div class="unconfirmed_points_circle diameter50">100</div>',b+="                     </div>",b+='                     <div class="text_help" data-ng-bind="translate.profile.purchases"></div>',b+='                     <div class="arrow"></div>',b+="                  </div>",b+='                  <div class="step step2">',b+='                     <div class="step_pic">',b+='                        <div class="card_pic"></div>',b+="                     </div>",b+='                     <div class="text_help" data-ng-bind="translate.profile.confirm_points"></div>',b+='                     <div class="arrow"></div>',b+="                  </div>",b+='                  <div class="step step3">',b+='                     <div class="step_pic">',b+='                        <div class="points_circle diameter50">400</div>',b+="                     </div>",b+='                     <div class="text_help" data-ng-bind="translate.profile.points_to_gift"></div>',b+="                  </div>",b+='                  <div class="clearfix"></div>',b+="               </div>",b+="            </div>",b+="         </div>",b+="      </td>",b+="   </tr>",b+="</table>",{restrict:"E",scope:!0,replace:!0,template:b,link:function(b){b.user_obj=!1,b.loaded=!0,b.show_points_help=!1,SAILPLAY.on("language.set.success",function(){SAILPLAY.send("load.user.info")}),b.change_type=function(b){a.$emit("route",b)},SAILPLAY.on("load.user.info.success",function(a){b.$apply(function(){b.user_obj=a})}),SAILPLAY.on("logout",function(){b.$apply(function(){b.user_obj=!1})})}}}]),b.directive("sailplayUserHistory",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class="user_history_wrapper myriad" data-ng-show="user && history.length > 0" data-ng-cloak>  <div class="user_history_inner"><h3 class="rockwell" data-ng-bind="translate.history.title"></h3><table class="myriad user_history_list"><tr data-ng-repeat="action in history">  <td style="width: 20%;"> <span class="history_item_date" data-ng-bind="action.action_date | date:\'dd.MM.yyyy\'"></span>  </td>  <td style="width: 70%; padding-right: 20px;"> <span data-ng-bind="action.name || (action | humanizeUserHistoryAction ) || translate.history.no_descr"></span>  </td>  <td style="text-align: right; width: 10%;"> <span data-ng-if="action.points_delta >= 0" class="history_item_points rockwell green_text" data-ng-bind="\'+\' + action.points_delta"></span> <span data-ng-if="action.points_delta < 0" class="history_item_points rockwell red_text" data-ng-bind="action.points_delta"></span>  </td></tr></table> </div> </div>',link:function(a){a.history=[],SAILPLAY.on("language.set.success",function(){SAILPLAY.send("load.user.history")}),SAILPLAY.on("load.user.info.success",function(b){a.$apply(function(){a.user=b.user})}),SAILPLAY.on("load.user.history",function(){a.$apply(function(){a.loaded=!1})}),SAILPLAY.on("load.user.history.success",function(b){a.$apply(function(){a.loaded=!0,a.history=b})}),SAILPLAY.on("load.user.history.error",function(){a.$apply(function(){a.loaded=!0,a.history=[]})}),SAILPLAY.on("logout",function(){a.$apply(function(){a.user=!1})})}}}),b.directive("sailplayGifts",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class="gifts_wrapper myriad" data-ng-show="gifts.length > 0" data-ng-cloak>  <div class="gifts_inner"><h3 class="rockwell" data-ng-bind="translate.gifts.title"></h3><p class="sub_title" data-ng-bind="translate.gifts.descr"></p><ul class="gifts_list">  <li class="gift" data-ng-repeat="gift in gifts" data-ng-click="selectGift(gift)"> <div class="gift_tools"><p data-ng-if="!user_obj" class="myriad" style="margin-top: 40px;">{{ translate.gifts.auth_request }}  <br/>  <button type="button" class="pj_btn rockwell" data-ng-click="loginRequest(gift)" data-ng-bind="translate.gifts.login"></button></p><p data-ng-if="user_obj" style="margin-top: 40px;">  <p class="myriad" data-ng-if="user_obj && (user_obj.user_points.confirmed - gift.points) < 0">  {{ translate.gifts.need_more_1 }} {{ (gift.points - user_obj.user_points.confirmed) | short_number }} {{ translate.gifts.need_more_2 }} <br/> <button type="button" data-ng-click="earnPoints(gift)" class="pj_btn rockwell" data-ng-bind="translate.gifts.get_points"></button>  </p>  <p class="myriad" data-ng-if="user_obj && (user_obj.user_points.confirmed - gift.points) >= 0">  {{ translate.gifts.enough_points }} <br/> <button type="button" class="pj_btn rockwell" data-ng-click="createPurchase(gift)" data-ng-bind="translate.gifts.to_basket"></button>  </p></p> </div> <div class="gift_points"><h3 class="rockwell" data-ng-bind="gift.points | short_number"></h3><p class="myriad" data-ng-bind="translate.gifts.points"></p> </div> <img data-ng-src="{{ gift.thumbs.url_250x250 }}" alt="{{ gift.name }}"/> <p class="rockwell truncate gift_name" data-ng-bind="gift.name"></p>  </li></ul> </div></div>',link:function(a){SAILPLAY.send("load.gifts.list"),SAILPLAY.on("language.set.success",function(){SAILPLAY.send("load.gifts.list")}),a.gifts=[],a.loaded=!0,SAILPLAY.on("load.user.info.success",function(b){a.$apply(function(){a.user_obj=b})}),SAILPLAY.on("load.gifts.list.success",function(b){a.$apply(function(){a.gifts=b})}),SAILPLAY.on("logout",function(){a.$apply(function(){a.user_obj=!1})}),SAILPLAY.on("gift.purchase.force_complete.success",function(){SAILPLAY.send("load.user.info"),SAILPLAY.send("load.user.history")}),a.createPurchase=function(a){SAILPLAY.send("gifts.purchase",a)},a.earnPoints=function(a){SAILPLAY.send("gifts.earn_points",a)},a.loginRequest=function(a){SAILPLAY.send("gifts.login.request",a)}}}}),b.directive("sailplayBadges",["$filter",function(a){return{restrict:"E",replace:!0,scope:!0,template:'<div class="badges_wrapper" data-ng-show="badges != {}" data-ng-cloak><h3 class="rockwell" data-ng-bind="translate.badges.title"></h3>  <p class="myriad" data-ng-bind="translate.badges.descr"></p>  <div data-ng-repeat="badge_chain in badges.multilevel_badges"><table class="badges_list">  <tr data-ng-init="divide_index = 0"><td style="width: 20px;">  <img class="slider_arrow" src="https://d3257v5wstjx8h.cloudfront.net/media/assets/assetfile/021caa0f7be7e572c26b84388ef000cb.png" alt="<" data-ng-click="divide_index = divide_index-1" data-ng-show="divide_index > 0"/></td><td data-ng-repeat="badge in badge_chain | divide:5:divide_index" class="badge">  <div class="badge_card" data-ng-click="selectBadge(badge, $parent.$index);"><img class="badge_pic" data-ng-src="{{ badge.is_received ? badge.thumbs.url_250x250 : badge.thumbs.url_gs }}" alt="{{ badge.name }}"/><p class="myriad truncate" data-ng-bind="badge.name"></p><img class="badge_arrow" data-ng-src="{{getArrowUrl()}}" alt=">" data-ng-hide="$last"/><div class="badge_info_arrow" data-ng-show="selectedBadges[$parent.$index] == badge"></div>  </div></td><td style="width: 20px;">  <img class="slider_arrow"  src="https://d3257v5wstjx8h.cloudfront.net/media/assets/assetfile/789b1ed470c1422c1a85783de0140152.png" alt=">" data-ng-click="divide_index = divide_index+1" data-ng-show="(divide_index + 5) < badge_chain.length"/></td></tr></table><div class="badge_info" data-ng-show="selectedBadges[$index]">  <div class="badge_descr myriad"><p data-ng-bind="selectedBadges[$index].descr"></p>  </div>  <p class="clearfix" style="margin-left: 10px;"><img width="40px" class="share_badge_btn" data-ng-click="shareBadge(selectedBadges[$index], \'fb\')" data-ng-src="{{ \'partners/pj/img/icons/share/fb.png\' | static }}" alt="FB"/><img width="40px" class="share_badge_btn" data-ng-click="shareBadge(selectedBadges[$index], \'vk\')" data-ng-src="{{ \'partners/pj/img/icons/share/vk.png\' | static }}" alt="VK"/>  </p></div>  </div>  <div data-ng-show="badges.one_level_badges.length > 0"><table class="badges_list" data-ng-init="divide_index = 0;">  <tr><td style="width: 20px;">  <img class="slider_arrow" src="https://d3257v5wstjx8h.cloudfront.net/media/assets/assetfile/021caa0f7be7e572c26b84388ef000cb.png" alt="<" data-ng-click="divide_index = divide_index-1" data-ng-show="divide_index > 0"/></td><td data-ng-repeat="badge in badges.one_level_badges | divide:5:divide_index" class="badge">  <div class="badge_card" data-ng-click="selectBadge(badge, \'one_level\');"><img class="badge_pic" data-ng-src="{{ badge.is_received ? badge.thumbs.url_250x250 : badge.thumbs.url_gs }}" alt="{{ badge.name }}"/><p class="myriad truncate" data-ng-bind="badge.name"></p><img class="badge_arrow" data-ng-src="{{getArrowUrl()}}" alt=">" data-ng-hide="$last"/><div class="badge_info_arrow" data-ng-show="selectedBadges.one_level == badge"></div>  </div></td><td style="width: 20px;">  <img class="slider_arrow"  src="https://d3257v5wstjx8h.cloudfront.net/media/assets/assetfile/789b1ed470c1422c1a85783de0140152.png" alt=">" data-ng-click="divide_index = divide_index+1" data-ng-show="(divide_index + 5) < badges.one_level_badges.length"/></td>  </tr></table><div class="badge_info" data-ng-show="selectedBadges.one_level">  <div class="badge_descr myriad"><p data-ng-bind="selectedBadges.one_level.descr"></p>  </div>  <p class="clearfix" style="margin-left: 10px;"><img width="40px" class="share_badge_btn" data-ng-click="shareBadge(selectedBadges.one_level, \'fb\')" data-ng-src="{{ \'partners/pj/img/icons/share/fb.png\' | static }}" alt="FB"/><img width="40px" class="share_badge_btn" data-ng-click="shareBadge(selectedBadges.one_level, \'vk\')" data-ng-src="{{ \'partners/pj/img/icons/share/vk.png\' | static }}" alt="VK"/>  </p></div>  </div></div>',link:function(a,b){a.getArrowUrl=function(){return"https://d3257v5wstjx8h.cloudfront.net/media/assets/assetfile/6212f474ff61b35c1d2100dceb3f6340.png"},a.badges={},SAILPLAY.send("load.badges.list"),SAILPLAY.on("login.success",function(a){SAILPLAY.send("load.badges.list")}),SAILPLAY.on("language.set.success",function(){SAILPLAY.send("load.badges.list")}),a.loaded=!0,SAILPLAY.on("load.badges.list.success",function(b){a.$apply(function(){a.badges=b})}),SAILPLAY.on("load.badges.list.error",function(b){a.$apply(function(){a.badges={}})}),a.shareBadge=function(a,b){var c,d={url:window.location.href,title:a.name,descr:a.descr,img:a.thumbs.url_250x250};"vk"==b?(c="http://vkontakte.ru/share.php?",c+="url="+encodeURIComponent(d.url),c+="&title="+encodeURIComponent(d.title),c+="&description="+encodeURIComponent(d.descr),c+="&image="+encodeURIComponent(d.img),c+="&noparse=true"):"fb"==b&&(c="http://www.facebook.com/sharer.php?s=100",c+="&t="+encodeURIComponent(d.title),c+="&u="+encodeURIComponent(d.url)),window.open(c,"","toolbar=0,status=0,width=626,height=436")},a.selectedBadges={one_level:!1},a.selectBadge=function(b,c){b==a.selectedBadges[c]?a.selectedBadges[c]=!1:a.selectedBadges[c]=b}}}}]),b.directive("sailplayActions",["$filter","$interval",function(a,b){return{restrict:"E",replace:!0,scope:!0,template:'<div class="actions_wrapper" data-ng-show="actions.length > 0" data-ng-cloak>  <h3 class="rockwell" style="margin:8px 0" data-ng-bind="translate.actions.title"></h3><p class="myriad" data-ng-bind="translate.actions.descr"></p><ul class="actions_list">  <li colspan="1" class="action" data-ng-repeat="action in actions"> <div class="action_card"><img class="action_pic" data-ng-src="{{ system_actions[action.type] || action.actionPic }}" alt="{{ action.descr }}" data-ng-if="!action.socialType"/><div data-ng-if="action.socialType" class="social_logo {{ action.socialType }} {{ action.action }}"></div><div class="action_points rockwell" data-ng-if="action.points > 0" data-ng-bind=" + (action.points | short_number)"></div><p class="myriad action_descr" data-ng-bind="translate.actions.system[action.type] || translate.actions.social[action.socialType][action.action].name || action.descr || translate.actions.no_descr"></p> <div class="earn_points_btn" data-ng-click="earnPoints(action)" data-sp-action="{{ action._actionId }}"><button class="pj_btn rockwell" data-ng-bind="translate.actions.earn_points"></button></div></div>  </li></ul> <div class="pj_ac_text" data-ng-show="is_sharable()" ><div class="pj_close_btn" data-ng-click="selected_action = false;">×</div><p class="myriad" data-ng-if="selected_action.action == \'like\'" data-ng-bind="translate.actions.ac_connected_join"></p><p class="myriad" data-ng-if="selected_action.action == \'partner_page\'" data-ng-bind="translate.actions.ac_connected"></p><button data-ng-if="selected_action.action == \'like\'" class="pj_btn rockwell"data-ng-bind="translate.actions.join" data-ng-click="earnPoints(selected_action)"></button><button data-ng-if="selected_action.action == \'partner_page\'" class="pj_btn rockwell"data-ng-bind="translate.actions.share" data-ng-click="earnPoints(selected_action)"></button></div></div>',link:function(c){c.actions=[],c.selected_action=!1,c.is_sharable=function(){return c.selected_action&&c.selected_action.account_connected},SAILPLAY.send("load.actions.list"),SAILPLAY.on("login.success",function(){var a=b(function(){c.actions.length>0&&(SAILPLAY.send("load.actions.list"),b.cancel(a))},100)}),SAILPLAY.on("language.set.success",function(){SAILPLAY.send("load.actions.list")}),SAILPLAY.on("load.actions.list.success",function(a){c.actions=a.actions,c.$apply()}),SAILPLAY.on("load.actions.list.error",function(){c.actions=[],c.selected_action=!1,c.$apply()}),c.earnPoints=function(a){c.selected_action=angular.copy(a),SAILPLAY.send("actions.perform",a)},SAILPLAY.on("actions.social.connect.complete",function(){SAILPLAY.send("load.actions.list")}),SAILPLAY.on("actions.perform.complete",function(){c.selected_action=!1,SAILPLAY.send("load.actions.list"),SAILPLAY.send("load.user.history")}),c.system_actions={emailBinding:a("static")("partners/pj/img/icons/actions/email_binding.png"),fillProfile:a("static")("partners/pj/img/icons/actions/fill_profile.png"),inviteFriend:a("static")("partners/pj/img/icons/actions/invite_friend.png")}}}}]),b.directive("sailplayBadgePopup",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class="receive_badge_popup myriad" data-sailplay-badge-popup data-ng-cloak><div class="window_closer" data-ng-click="closeBadgePopup()">&#215;</div><table><tr><td style="width: 130px;text-align: center;"><img class="badge_pic" data-ng-src="{{ badge.pic || badge.thumbs.url_250x250 }}" alt="{{ badge.name }}"/><p style="text-align: center; margin: 8px 0;">{{ badge.name }}</p></td><td><h3 class="rockwell" data-ng-bind="translate.badges.intro"></h3><p style="margin-top: 10px;">{{ translate.badges.this_badge }} <br/> <strong class="red_text" style="font-weight: 600;" data-ng-bind="badge.points + \' \' + translate.badges.bonus_points"></strong></p><p style="margin-top: 20px;"><span style="vertical-align: middle; margin-right: 8px;" data-ng-bind="translate.badges.share_this_news"></span><img style="vertical-align: middle;" width="40px" class="share_badge_btn" data-ng-click="shareBadge(badge, \'fb\')" data-ng-src="{{ \'partners/pj/img/icons/share/fb.png\' | static }}" alt="FB"/><img style="vertical-align: middle;" width="40px" class="share_badge_btn" data-ng-click="shareBadge(badge, \'vk\')" data-ng-src="{{ \'partners/pj/img/icons/share/vk.png\' | static }}" alt="VK"/></p></td></tr></table></div>',link:function(a,b){a.badge={},SAILPLAY.on("badge.receive.show",function(c){a.badge=angular.copy(c),b[0].style.display="block",a.$apply()}),SAILPLAY.on("badge.receive.hide",function(){b[0].style.display="none"}),a.closeBadgePopup=function(){SAILPLAY.send("badge.receive.hide")},a.shareBadge=function(a,b){var c,d={url:window.location.href,title:a.name,descr:a.descr,img:a.pic};"vk"==b?(c="http://vkontakte.ru/share.php?",c+="url="+encodeURIComponent(d.url),c+="&title="+encodeURIComponent(d.title),c+="&description="+encodeURIComponent(d.descr),c+="&image="+encodeURIComponent(d.img),c+="&noparse=true"):"fb"==b&&(c="http://www.facebook.com/sharer.php?s=100",c+="&t="+encodeURIComponent(d.title),c+="&u="+encodeURIComponent(d.url)),window.open(c,"","toolbar=0,status=0,width=626,height=436")}}}}),b.directive("sailplayPizzameter",["translate","$filter",function(a,b){return{restrict:"E",replace:!0,scope:!0,template:'<div data-ng-cloak class="pizzameter_wrapper" data-ng-style="{ backgroundImage: wrapperBG() }">  <div class="pizza_pieces" data-ng-style="{ backgroundImage: pizzaBG() }"></div><div class="pizzameter_counter" data-ng-style="{ backgroundImage: counterBG() }">  <div class="counter_inner"> <img data-ng-repeat="digit in visible_points track by $index" data-ng-src="{{ getPointsDigitUrl(digit) }}" alt="{{ digit }}"/>  </div></div> </div>',link:function(c){c.target_points=0,c.user_points=0,c.visible_points="0000".split(""),SAILPLAY.on("load.user.info.success",function(a){c.$apply(function(){c.user_points=a.user_points.confirmed;for(var b=a.user_points.confirmed.toString().split("");b.length<4;)b.unshift("0");c.visible_points=b})}),SAILPLAY.on("pj.pizzameter",function(a){c.$apply(function(){c.target_points=a})}),SAILPLAY.on("purchase.widget.show",function(a){c.$apply(function(){c.user_points=a.user_points||c.user_points;for(var b=c.user_points.toString().split("");b.length<4;)b.unshift("0");c.visible_points=b})}),c.wrapperBG=function(){return"url("+b("static")("")+"partners/pj/img/pizzameter/deck_"+a.lang+".png)"},c.counterBG=function(){return"url("+b("static")("")+"partners/pj/img/pizzameter/counter_"+a.lang+".png)"},c.pizzaBG=function(){var a=8,d=c.user_points/c.target_points;return d<1&&(d=Math.round(10*d),a=d>8?a:d),"url("+b("static")("")+"partners/pj/img/pizzameter/"+(a||1)+"_piece.png)"},c.getPointsDigitUrl=function(a){return b("static")("")+"partners/pj/img/pizzameter/digits/"+a+".png"}}}}]),b.directive("sailplayPurchaseWidget",["translate",function(a){var b="";return b+='<div style="padding: 20px;" ng-click="goToPapaBonus()" ng-if="redirect_url">',b+='              <table width="240px">',b+="                <tr>",b+="                  <td colspan=\"1\" style='vertical-align: middle; text-align: center;'>",b+='                    <p class=\'rockwell\' style="text-align: center; font-size: 18px; font-weight: bold; padding: 10px; white-space: nowrap; overflow: hidden;" data-ng-bind-html="translate.purchase.papa_bonus | to_html"></p>',b+="                  </td>",b+="                </tr>",b+="                <tr>",b+='                  <td colspan="1" style="text-align:center;vertical-align: middle;">',b+='                    <sailplay-pizzameter style="width:180px; height: 180px; margin:12px 0 26px 0;"></sailplay-pizzameter>',b+="                  </td>",b+="                </tr>",b+="              </table>",b+='              <table width="240px">',b+="                <tr>",b+="                  <td style='vertical-align: middle;'>",b+='                    <p style="text-align:justify" ng-bind="translate.purchase.promo_text"></p>',b+="                  </td>",b+="                </tr>",b+="              </table>",b+='              <table width="240px" style="margin: 20px 0px">',b+="                <tr>",b+="                  <td width=\"33%\" style='vertical-align: middle;'>",b+='                    <div class="points_circle confirmed oldify" style="float:left">',b+='                      <span class="rockwell" data-ng-bind="purchase_points"></span>',b+="                    </div>",b+="                  </td>",b+="                  <td style='vertical-align: middle;' >",b+='                    <p style="font-weight: bold;" data-ng-bind="translate.purchase.purchase_points"></p>',b+="                  </td>",b+="",b+="                </tr>",b+="              </table>",b+='              <table width="240px" style="margin: 10px 0px;  border-top: 1px solid black; border-bottom: 1px solid black">',b+="                <tr>",b+='                  <td width = "10%"  style="padding-right:5px; padding-top:10px; padding-bottom: 10px; vertical-align: middle;">',b+='                    <img src="https://d3257v5wstjx8h.cloudfront.net/media/assets/assetfile/547050456db67d33008ffeb4002ff7ea.png" width="27" height="27">',b+="                  </td>",b+='                  <td width = "10%" style="padding-right:5px; padding-top:10px; padding-bottom: 10px; vertical-align: middle;">',b+='                    <img src="https://d3257v5wstjx8h.cloudfront.net/media/assets/assetfile/97dd4019dcffa12481ead1af7f836a16.png" width="27" height="27">',b+="                  </td>",b+='                  <td width = "10%" style="padding-right:5px; padding-top:10px; padding-bottom: 10px; vertical-align: middle;">',b+='                    <img src="https://d3257v5wstjx8h.cloudfront.net/media/assets/assetfile/6736393657591fb0d856c6fa4ca9d414.png" width="27" height="27">',b+="                  </td>",b+='                  <td width = "70%" style="text-align: center; padding-top:10px; padding-bottom: 10px; vertical-align: middle;">',b+='                    <p style="text-align: center" >+{{bonus_per_invite || 0}} {{translate.purchase.bonus_for_sharing}}</p>',b+="                  </td>",b+="                </tr>",b+="              </table>",b+='              <table width="240px">',b+="                <tr>",b+='                  <td style="text-align: center">',b+='                    <a href="javascript:void(0)" class="pj_btn rockwell ng-binding" data-ng-click="loginRequest(gift)" data-ng-bind="translate.purchase.link_text" style="color: white; border:0; display: block; margin-top: 12px;"></a>',b+="                  </td>",b+="                </tr>",b+="              </table>",b+="            </div>",{restrict:"E",replace:!0,scope:!0,template:b,link:function(a){a.goToPapaBonus=function(){location.href=a.redirect_url||"/papaBonus"},SAILPLAY.on("load.user.info.success",function(b){a.$apply(function(){a.user_points=b.user_points.confirmed})}),SAILPLAY.on("purchase.widget.show",function(b){a.$apply(function(){a.purchase_points=b.purchase_points||a.purchase_points,a.user_points=b.user_points||a.user_points,a.bonus_per_invite=b.bonus_per_invite||a.bonus_per_invite,a.redirect_url=b.redirect_url||a.redirect_url})})}}}]),b.directive("sailplayWidgets",["$rootScope",function(a){return{restrict:"E",replace:!0,scope:!0,template:'<div class="sailplay-widget-wrapper">\n\n    <style>\n        \n        .user_badge:before {\n            display: none;\n        }\n        \n        .n-steps__item .n-steps__corner {\n            fill: url("#gradfirst");\n        }\n\n        .n-steps__corner-line {\n            fill: url("#line");\n        }\n\n        .n-steps__item_state_active + .n-steps__item > .n-steps__corner {\n            fill: url("#gradfirst");\n        }\n\n        .n-steps__item_state_active .n-steps__corner {\n            fill: url("#gradsecond");\n        }\n\n        /* todo вынести в style.css */\n        .n-probonus--logged-in {\n            height: 118px;\n            padding-left: 188px;\n        }\n\n        .n-probonus--logged-in .n-pizzameter {\n            top: 10px;\n            width: 100px;\n        }\n\n        .n-probonus--logged-in .pizzameter_wrapper {\n            width: 100px;\n            height: 100px;\n            left: 24px;\n            top: -21px;\n        }\n\n        .n-probonus--logged-in .n-probonus__head {\n            padding-top: 30px;\n        }\n\n        .user_info_wrapper {\n            background-color: white !important; /* todo убрать, когда sailplay у себя поправит */\n            margin-bottom: -5px;\n        }\n\n        .n-probonus .pizzameter_wrapper {\n            position: absolute;\n            left: 10px;\n            width: 200px;\n            height: 200px;\n            top: 47px;\n        }\n\n        .pizzameter_wrapper {\n            left: 10px;\n            margin: 10px 20px 10px 10px;\n            top: 0;\n        }\n\n        .n-steps__hint {\n            text-align: center;\n        }\n\n        .actions_wrapper .rockwell {\n            margin-bottom: 10px;\n        }\n\n        .n-probinus-authed {\n            height: 277px;\n            position: relative;\n            background-color: #fff;\n        }\n\n        .n-probinus-authed .n-papabonus__attention {\n            border: 1px dotted #bdbbb5;\n            background: #FAE6DD;\n            position: absolute;\n            z-index: 999;\n            right: 0px;\n            width: 562px;\n            top: 199px;\n            height: 66px;\n            padding-top: 10px;\n            padding-left: 20px;\n            padding-right: 20px;\n        }\n\n        .n-probinus-authed table tbody tr:first-child {\n            height: 100px;\n        }\n\n        .n-probinus-authed .n-left__attention {\n            float: left;\n            height: 36px;\n        }\n\n        .n-probinus-authed .n-right__attention {\n            float: right;\n        }\n    </style>\n\n    <div class="n-probonus" data-ng-show="!auth">\n\n        <sailplay-pizzameter></sailplay-pizzameter>\n\n        <div class="n-probonus__head">\n            Участвуйте в бонусной программе\n            <nobr class="n-probonus__name">«ПапаБонус»!</nobr>\n        </div>\n\n        <div class="n-probonus__about">\n            <i class="n-probonus__img"></i>\n            <p>У нас есть потрясающая бонусная программа для вас, благодаря которой вы можете получать баллы за покупки\n                товаров на нашем сайте. За эти баллы вы сможете получать подарки из нашего ассортимента!</p>\n        </div>\n\n    </div>\n\n    <div data-ng-show="auth">\n        <sailplay-user-pizza-profile></sailplay-user-pizza-profile>\n    </div>\n    \n    <div class="n-steps">\n        <ul class="n-steps__list">\n            <li class="n-steps__item"\n                data-ng-class="{ \'n-steps__item_state_active\' : type == \'menu\' }">\n                <a href="#" class="n-steps__inner n-steps__inner-pizza"\n                   data-ng-click="$event.preventDefault();type = \'menu\';">\n                    <p class="n-steps__name">Заказать пиццу</p>\n                    <p class="n-steps__hint">5 баллов за каждые 100 рублей</p>\n                </a>\n            </li>\n            <li class="n-steps__item "\n                data-ng-class="{ \'n-steps__item_state_active\' : type == \'earn\' }">\n                <a href="#" class="n-steps__inner n-steps__inner-earnPoints"\n                   data-ng-click="$event.preventDefault();type = \'earn\';">\n                    <p class="n-steps__name">Заработать дополнительные баллы</p>\n                </a>\n                <svg width="40" height="98" class="n-steps__corner" xmlns="http://www.w3.org/2000/svg" version="1.1"\n                     viewBox="0 0 40 98">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#n-steps__corner"></use>\n                </svg>\n                <svg width="40" height="98" class="n-steps__corner-line" xmlns="http://www.w3.org/2000/svg"\n                     version="1.1" viewBox="0 0 40 98">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#n-steps__corner-line"></use>\n                </svg>\n            </li>\n            <li class="n-steps__item "\n                data-ng-class="{ \'n-steps__item_state_active\' : type == \'gifts\' }">\n                <a href="#" class="n-steps__inner n-steps__inner-gifts"\n                   data-ng-click="$event.preventDefault();type = \'gifts\';">\n                    <p class="n-steps__name">Получить подарки</p>\n                </a>\n                <svg width="40" height="98" class="n-steps__corner" xmlns="http://www.w3.org/2000/svg" version="1.1"\n                     viewBox="0 0 40 98">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#n-steps__corner"></use>\n                </svg>\n                <svg width="40" height="98" class="n-steps__corner-line" xmlns="http://www.w3.org/2000/svg"\n                     version="1.1" viewBox="0 0 40 98">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#n-steps__corner-line"></use>\n                </svg>\n            </li>\n        </ul>\n        <svg width="40" height="98" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 40 98">\n            <symbol id="n-steps__corner">\n                <polygon class="n-steps__corner" points="1,-1 40,0 40,98 1,99 40,49"></polygon>\n            </symbol>\n            <symbol id="n-steps__corner-line">\n                <polygon class="n-steps__corner-line" points="2,0 40,49 2,98 -0.5,98 37.5,49 -0.5,0"></polygon>\n            </symbol>\n            <linearGradient id="gradsecond" x1="0%" y1="0%" x2="0%" y2="100%">\n                <stop stop-color="#830707" offset="0%"></stop>\n                <stop stop-color="#8c0809" offset="19%"></stop>\n                <stop stop-color="#a20c0d" offset="50%"></stop>\n                <stop stop-color="#b60f18" offset="50%"></stop>\n                <stop stop-color="#af0e18" offset="62%"></stop>\n                <stop stop-color="#920b11" offset="86%"></stop>\n                <stop stop-color="#860a0d" offset="100%"></stop>\n            </linearGradient>\n            <linearGradient id="gradfirst" x1="0%" y1="0%" x2="0%" y2="100%">\n                <stop stop-color="#cb120c" offset="0%"></stop>\n                <stop stop-color="#d81f17" offset="50%"></stop>\n                <stop stop-color="#e0282a" offset="50%"></stop>\n                <stop stop-color="#df2629" offset="60%"></stop>\n                <stop stop-color="#cf1d1b" offset="90%"></stop>\n                <stop stop-color="#cd1a16" offset="100%"></stop>\n            </linearGradient>\n\n            <linearGradient id="line" x1="0%" y1="0%" x2="0%" y2="100%">\n                <stop stop-color="#991208" offset="0%"></stop>\n                <stop stop-color="#b21f0f" offset="50%"></stop>\n                <stop stop-color="#c4281c" offset="50%"></stop>\n                <stop stop-color="#be261b" offset="62%"></stop>\n                <stop stop-color="#a41d12" offset="88%"></stop>\n                <stop stop-color="#9c1a0f" offset="100%"></stop>\n            </linearGradient>\n        </svg>\n    </div>\n\n    <div data-ng-show="type == \'menu\'">\n\n        <ol class="n-actlist">\n            <li class="n-actlist__item n-actlist__item_step_order">\n                <div class="n-actlist__head">Заказать пиццу</div>\n                <div class="n-actlist__text">За каждые 100 рублей, потраченные на&nbsp;пиццу, вы&nbsp;получите 5&nbsp;бонусных\n                    баллов.\n                </div>\n                <a href="/menyu/pizza">\n                    <div class="n-actlist__btn b-btn b-btn_color_green">Заказать пиццу</div>\n                </a>\n            </li>\n            <li class="n-actlist__item n-actlist__item_step_points">\n                <div class="n-actlist__head">Зарабатывайте баллы и&nbsp;награды</div>\n                <div class="n-actlist__text">Рассказывайте о&nbsp;подарках в&nbsp;социальных сетях. Вступайте в&nbsp;группы\n                    ПапаДжон`с в&nbsp;ВКонтакте и&nbsp;Facebook Приглашайте друзей\n                </div>\n                <a href="#" data-ng-click="$event.preventDefault();type = \'earn\';">\n                    <div class="n-actlist__btn b-btn b-btn_color_green">Заработать баллы</div>\n                </a>\n            </li>\n            <li class="n-actlist__item n-actlist__item_step_presents">\n                <div class="n-actlist__head">Получить подарки</div>\n                <div class="n-actlist__text">Накопленные баллы вы&nbsp;cможете потратить на&nbsp;подарки при\n                    следующем\n                    заказе\n                </div>\n                <a href="#" data-ng-click="$event.preventDefault();type = \'gifts\';">\n                    <div class="n-actlist__btn b-btn b-btn_color_green">Выбрать подарок</div>\n                </a>\n            </li>\n        </ol>\n\n    </div>\n\n    <div data-ng-show="type == \'earn\'">\n\n        <sailplay-actions></sailplay-actions>\n\n        <sailplay-badges></sailplay-badges>\n\n    </div>\n\n\n    <div data-ng-show="type == \'gifts\'">\n\n        <sailplay-gifts></sailplay-gifts>\n\n    </div>\n\n    <div data-ng-show="type == \'history\'">\n\n        <sailplay-user-history></sailplay-user-history>\n\n    </div>\n\n</div>',link:function(b,c){b.type="menu",b.auth=!1,a.$on("route",function(a,c){b.type=c}),SAILPLAY.on("load.user.info.success",function(a){b.$apply(function(){b.auth=!0})})}}}]),a.on("pj.bootstrap",function(a){angular.bootstrap(a,["sailplay.pj"])})}(SAILPLAY);